@unit-test
 Feature: Rps server inbound/outbound pipeline

   Scenario: Message forwarded to receiver
     Given that the following byte sequence "00 04 02 1C"
     When the data is received
     Then the receiver receives a message of type "RPS_QUERY"

    Scenario: Message sent to peer
      Given an RPS peer message with address "192.168.1.1", port "9090" and hostkey "MIICIjANBgkqhkiG9w0BAQEFAAOCAg8AMIICCgKCAgEAxMwNFe+C2+jKtRew52DLW6Sc5F1Lb4mer9Ffy6GgjzkHtdg0lynt9FbZdCSAfcGsiwsPLHKJau6ED932XuLvutmO2Ys0TjL1aBi0rHsLqoXG7ek+BrsSraETQK3rJFvGddF2E009/sM8CnFD4FjjJ8LF5/i5WAGiW9J0IiSBzXokIR+whSLiqP+X1KzKC446FHNvBvklaObfxDL2tr82ST4qqWq8h08y0J5qG1FkW9CMYrIracHzrvNc4y6DXkAZKJ2tvIwAelNILoOagAcg9Y3Mtqob162sJaNzJwgAo1vmkifMY9GSCEH72dwamToKQThSOh46QmwFWH5JCjGTH9Qlo9fz/jol6FL+ER2TQ66VsVIbChRyHenJ9gclokLOE4TutkkjE7iZjLasT1nv06nws4KbnUVjQ7SPQfm/W3rqP8tzu8EaKivbAW/AM+myLQNcGEW6jPb6y8mRkJQl/nYNGU1BhYngGp1kR9uF1gfAiB8hVfqS+ZZsqH8cKXXnGapwsCEmCvdM/sZR0zQJWk+Wta/oEawMWI9D29K4d887fpwt0JyuEDFS6FfLf8K/xVmq/pVALIUGlaJTw968ikTgWFiisMX63kj0WN3BD9iykSbn45n9zWrD/sjQuK9Lo4dZwiA2Wwx7mNrhSBl8+WOdjVnUr4v+HwnKKhHmvDsCAwEAAQ=="
      When the message is sent out
      Then the peer receives the following byte sequence "0232021D23820004C0A8010130820222300D06092A864886F70D01010105000382020F003082020A0282020100C4CC0D15EF82DBE8CAB517B0E760CB5BA49CE45D4B6F899EAFD15FCBA1A08F3907B5D8349729EDF456D97424807DC1AC8B0B0F2C72896AEE840FDDF65EE2EFBAD98ED98B344E32F56818B4AC7B0BAA85C6EDE93E06BB12ADA11340ADEB245BC675D176134D3DFEC33C0A7143E058E327C2C5E7F8B95801A25BD274222481CD7A24211FB08522E2A8FF97D4ACCA0B8E3A14736F06F92568E6DFC432F6B6BF36493E2AA96ABC874F32D09E6A1B51645BD08C62B22B69C1F3AEF35CE32E835E4019289DADBC8C007A53482E839A800720F58DCCB6AA1BD7ADAC25A373270800A35BE69227CC63D1920841FBD9DC1A993A0A4138523A1E3A426C05587E490A31931FD425A3D7F3FE3A25E852FE111D9343AE95B1521B0A14721DE9C9F60725A242CE1384EEB6492313B8998CB6AC4F59EFD3A9F0B3829B9D456343B48F41F9BF5B7AEA3FCB73BBC11A2A2BDB016FC033E9B22D035C1845BA8CF6FACBC991909425FE760D194D418589E01A9D6447DB85D607C0881F2155FA92F9966CA87F1C2975E719AA70B021260AF74CFEC651D334095A4F96B5AFE811AC0C588F43DBD2B877CF3B7E9C2DD09CAE103152E857CB7FC2BFC559AAFE95402C850695A253C3DEBC8A44E05858A2B0C5FADE48F458DDC10FD8B29126E7E399FDCD6AC3FEC8D0B8AF4BA38759C220365B0C7B98DAE148197CF9639D8D59D4AF8BFE1F09CA2A11E6BC3B0203010001"